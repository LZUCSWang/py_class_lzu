<!doctype html>
<html lang="en">
<head>
    {% load static %}
	<meta charset="utf-8" />
	<link rel="icon" type="image/png" href="/static/img/favicon.ico">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>数据下载 - 政务数据网站</title>
	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />
    <link href="/static/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/static/css/animate.min.css" rel="stylesheet"/>
    <link href="/static/css/light-bootstrap-dashboard.css" rel="stylesheet"/>
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>
    <link href="/static/css/pe-icon-7-stroke.css" rel="stylesheet" />
</head>
<body>
<div class="wrapper">
    <div class="sidebar" data-color="blue">
    	<div class="sidebar-wrapper">
            <div class="logo">
                <a href="#" class="simple-text">
                    政务数据网站
                </a>
            </div>
            <ul class="nav">
                <li>
                    <a href="/"><i class="pe-7s-home"></i><p>首页</p></a>
                </li>
                <li>
                    <a href="/data/"><i class="pe-7s-note2"></i><p>数据查询</p></a>
                </li>
                <li>
                    <a href="/download/"><i class="pe-7s-cloud-download"></i><p>数据下载</p></a>
                </li>
                <li class="active">
                    <a href="/charts/"><i class="pe-7s-graph"></i><p>数据分析可视化</p></a>
                </li>
                <li class="active-pro">
                    <a href="/login/"><i class="pe-7s-right-arrow"></i><p>进入 管理系统</p></a>
                </li>
            </ul>
    	</div>
    </div>

    <div class="main-panel">
        <nav class="navbar navbar-default navbar-fixed">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">欢迎您，用户 {{ request.user.username }}</a>
                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                           <a href="/logout/">退出登录</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- 内容 -->
        <div class="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">数据分析可视化</h4>
                                <p class="category">在这里通过echarts对政务数据增幅情况进行可视化</p>
                            </div>
                           <div class="content">
                                <div id="chart" style="height: 500px"></div>
                                <div id="wordcloud" style="height: 660px;margin:60px 0;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <footer class="footer">
            <div class="container-fluid">
                <nav class="pull-left">
                    <ul>
                        <li>
                            <a href="/data/">
                                政务数据网站
                            </a>
                        </li>

                    </ul>
                </nav>
                <p class="copyright pull-right">
                </p>
            </div>
        </footer>

    </div>
</div>
</body>
    <script src="/static/js/jquery-1.10.2.js" type="text/javascript"></script>
	<script src="/static/js/bootstrap.min.js" type="text/javascript"></script>
	<script src="/static/js/bootstrap-checkbox-radio-switch.js"></script>
    <script src="/static/js/bootstrap-notify.js"></script>
	<script src="/static/js/light-bootstrap-dashboard.js"></script>
	<script src="/static/js/demo.js"></script>
	<script src="/static/js/echarts.min.js"></script>
    <script>
        var dom5 = document.getElementById("chart");
        var myChart5 = echarts.init(dom5);
        var option5 = {
            color: ['#ff7b7c', '#73DEB3', '#87878b','#45C2E0', '#C1EBDD', '#FFC851','#5A5476','#1869A0','#FF9393'],
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross',
                    crossStyle: {
                        color: '#999'
                    },
                    lineStyle: {
                        type: 'dashed'
                    }
                }
            },
            grid: {
                left: '25',
                right: '25',
                bottom: '24',
                top: '66',
                containLabel: true
            },
            legend: {
                data: {{ citys|safe }},
                orient: 'horizontal',
                icon: "rect",
                show: true,
                left: 20,
                top: 0,
            },
            xAxis: {
                type: 'category',
                data: {{ dates|safe }},
                splitLine: {
                    show: false
                },
                axisTick: {
                    show: false
                },
                axisLine: {
                    show: false
                },
            },
            yAxis: {
                type: 'value',
                axisLabel: {
                    color: '#999',
                    textStyle: {
                        fontSize: 12
                    },
                },
                splitLine: {
                    show: true,
                    lineStyle: {
                        color: '#F3F4F4'
                    }
                },
                axisTick: {
                    show: false
                },
                axisLine: {
                    show: false
                },
            },
            series: [{% for i in datas %}
                {
                    name: '{{ i.name }}',
                    type: 'line',
                    smooth: true,
                    data: {{ i.data|safe }}
                },
                {% endfor %}
            ]
        };
        myChart5.setOption(option5, true);
        </script>
    <script src="{% static 'js/echarts.js' %}"></script>
	<script src="/static/js/echarts-wordcloud.js"></script>
    <script>
            var chart = echarts.init(document.getElementById('wordcloud')); <!-- 创建echarts对象 -->

            var keywords = {{worddic|safe}}; <!-- 获取词频 -->

            var data = []; <!-- 封装词频数据，成为字典数组，用于词云图 -->
            for (var name in keywords) {
                data.push({
                    name: name,
                    value: Math.sqrt(keywords[name])
                })
            }

            var maskImage = new Image(); <!-- 创建图片对象，用于词云图形状的显示 -->
            maskImage.src ="{% static 'img/logo.jpg' %}";

            var option = { <!-- 词云图配置-->
                series: [ {
                    type: 'wordCloud', <!-- 图表类型：词云图 -->
                    sizeRange: [10, 100],<!-- 文字大小 -->
                    rotationRange: [-90, 90],<!-- 文字旋转角度 -->
                    rotationStep: 45, <!-- 文字旋转步长 -->
                    gridSize: 2, <!-- 词云中每个词的间距 -->
                    width: '660px',
                    height: '680px',
                    {#shape: 'pentagon',#}
                    maskImage: maskImage,<!-- 词云轮廓图，白色区域将被排除在绘图文本之外 -->
                    textStyle: {  <!-- 文字设置，color颜色，random随机rgb颜色 -->
                        normal: {
                            color: function () {
                                return 'rgb(' + [
                                    Math.round(Math.random() * 160),
                                    Math.round(Math.random() * 160),
                                    Math.round(Math.random() * 160)
                                ].join(',') + ')';
                            }
                        },
                        emphasis: {<!-- 鼠标移动到文字的颜色 -->
                            color: 'red'
                        }
                    },
                    data: data
                } ]
            };
            maskImage.onload = function () { <!-- 载入词云图 -->
                chart.setOption(option);
            }

    </script>
</html>
